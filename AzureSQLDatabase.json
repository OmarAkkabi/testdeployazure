{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "databaseServer": {
      "type": "string"
    },
    "costCenter": {
      "type": "string",
      "allowedValues": [
        "Procurement",
        "Marketing",
        "IT"
      ]
    },
    "SqlAdminLogin": {
      "type": "string",
      "defaultValue": "Standard",
      "metadata": {
        "description": "The SA login name"
      }
    },
    "SqlAdminPassword": {
      "type": "securestring"
    },
    "databaseName": {
      "type": "string"
    },
    "databaseCollation": {
      "type": "string",
      "defaultValue": "SQL_Latin1_General_CP1_CI_AS"
    },
    "maxSizeBytes": {
      "type": "string",
      "allowedValues": [
        "2147483648",
        "10995116277760"
      ]
    },
    "databaseEdition": {
      "type": "string",
      "allowedValues": [
        "Basic",
        "Standard",
        "Premium"
      ]
    }
  },
  "variables": {
    "databaseServerName": "[toLower(parameters('databaseServer'))]",
    "databaseServerLocation": "West Europe",
    "defaultSecondaryLocation": "North Europe",
    "databaseServerAdminLogin": "[parameters('SqlAdminLogin')]",
    "databaseServerAdminLoginPassword": "[parameters('sqlAdminPassword')]"
  },
  "resources": [
    {
      "name": "[variables('databaseServerName')]",
      "type": "Microsoft.Sql/servers",
      "location": "westeurope",
      "apiVersion": "2014-04-01-preview",
      "dependsOn": [],
      "tags": {
        "CostCenter": "[parameters('CostCenter')]"
      },
      "properties": {
        "administratorLogin": "[variables('databaseServerAdminLogin')]",
        "administratorLoginPassword": "[variables('databaseServerAdminLoginPassword')]",
        "version": "12.0"
      }
    },
    {
      "type": "Microsoft.Sql/servers/firewallrules",
      "name": "[concat(variables('databaseServerName'),'/BusinessProxyAPnat')]",
      "apiVersion": "2014-04-01-preview",
      "location": "[variables('databaseServerLocation')]",
      "properties": {
        "startIpAddress": "156.114.2.28",
        "endIpAddress": "156.114.2.28"
      },
      "resources": [],
      "dependsOn": [
        "[concat('Microsoft.Sql/servers/', variables('databaseServerName'))]"
      ]
    },
    {
      "apiVersion": "2014-04-01-preview",
      "type": "Microsoft.Sql/servers/databases",
      "dependsOn": [
        "[concat('Microsoft.Sql/servers/', variables('databaseServerName'))]"
      ],
      "location": "[variables('databaseServerLocation')]",
      "name": "[concat(variables('databaseServerName'), '/', string(parameters('databaseName')))]",
      "properties": {
        "collation": "[parameters('databaseCollation')]",
        "edition": "[parameters('databaseEdition')]",
        "defaultSecondaryLocation": "[variables('defaultSecondaryLocation')]",
        "maxSizeBytes": "[parameters('maxSizeBytes')]"
      },
      "tags": {
        "CostCenter": "[parameters('CostCenter')]"
      }
    }
  ],
  "outputs": {}
}